<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
     <meta http-equiv="content-type" content="application/xhtml+xml; charset=utf-8" />
     <link rel = "stylesheet" type = "text/css" href = "/listas.css" />
     <script>
     function loadPageToDiv(page, div)
     {
     		var httpRequest;
			if (window.XMLHttpRequest)
			{
				//El explorador implementa el interfaz de forma nativa
				httpRequest = new XMLHttpRequest();
			} 
			else if (window.ActiveXObject)
			{
				//El explorador permite crear objetos ActiveX
				try {
					httpRequest = new ActiveXObject("MSXML2.XMLHTTP");
				} catch (e) {
					try {
						httpRequest = new ActiveXObject("Microsoft.XMLHTTP");
					} catch (e) {}
				}
			}
			if (!httpRequest)
			{
				alert("No ha sido posible crear una instancia de XMLHttpRequest");
			}
			
			var destination = div
			
			httpRequest.onreadystatechange = function()
			{
				alert(" estado " + httpRequest.stateChange)
		        if (httpRequest.stateChange==4) {
					
		            if (httpRequest.status==200) {
		            	alert(httpRequest.responseText)
		                destination.innerHTML = httpRequest.responseText;
		            }
		            else
		            {
		            	alert("error")
		            }
		        }
			}
			httpRequest.open("GET",page, true)
			httpRequest.send()
     }
     
     function showContent(id, art_id)
     {
     	var n = document.getElementById(id);
% if nocontent: 
		n.innerHTML = 'Cargando...'
		loadPageToDiv("/veronica/content?id=" + art_id, n)
% endif
		if (n.style.display == 'none' || !n.style.display)
			n.style.display = 'block';
		else
			n.style.display='none';
		
     }
     
     function gotoSimilar(article_id)
     {
     	document.location.href="/veronica/similar?id=" + article_id
     }
    </script>
  </head>
	<body>
		<h1>${title}</h1>
% for i, art in enumerate(articles):
			<div class="result">
                <div class="date">${art.pub_date.strftime("%H:%M %d/%m/%Y")}</div>
                <div class="feed"><a href="/veronica/lastByFeed?id=${art.feed.id}">${art.feed.title}</a> </div>
                <div class="article"><input class="plus_button" type="button" value="+" onclick="showContent('content_${i}', ${art.id});"><input class="similar_button" type="button" value="~" onclick="gotoSimilar(${art.id});"> <a href = "${art.link}">${art.title}</a></div>
                <div id="content_${i}" class="content">${art.content}</div>
			</div>
% endfor
	Tiempo query BD: ${db_elapsed} segundos. <br />
	</body>
</html>
